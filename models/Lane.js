const mongoose = require('mongoose');
const { Schema } = mongoose;

const laneSchema = new Schema({
  name: { type: 'String', required: true },
  notes: [{ type: Schema.ObjectId, ref: 'Note', required: true }],
  id: { type: 'String', required: true, unique: true },
  _user: { type: Schema.Types.ObjectId, ref: 'User' }
});

function populateNotes(next) {
  this.populate('notes');
  next();
}

laneSchema.pre('find', populateNotes);
laneSchema.pre('findOne', populateNotes);

mongoose.model('lane', laneSchema);
